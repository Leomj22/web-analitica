<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horarios de Salida y Llegada</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Horarios de Salida y Llegada</h1>
        <div>
            <img src="imagenes/logo-empresa.webp" alt="logo">
        </div>
        <nav>
            <ul>
                <li><a href="index.html">Inicio</a></li>
                <li><a href="boletos.html">Boletos</a></li>
                <li><a href="quienes-somos.html">Quienes Somos</a></li>
                <li><a href="#contacto">Contacto</a></li> <!-- Enlace a la sección de contacto en el footer -->
            </ul>
        </nav>
    </header>

    <section id="horarios">
        <h2>Horarios Disponibles</h2>
        <p>Para el viaje desde <span id="origen"></span> a <span id="destino"></span>, con <span id="personas"></span> persona(s) el <span id="fecha"></span>.</p>

        <!-- Aquí se mostrarán los horarios dinámicamente -->
        <ul id="lista-horarios">
            <!-- Los horarios serán generados con JavaScript -->
        </ul>

        <!-- Contenedor para mostrar el costo total -->
        <div id="costo-total">
            <!-- El costo total se mostrará aquí -->
        </div>
    </section>

    <script>
        // Obtener los parámetros de la URL
        const params = new URLSearchParams(window.location.search);
        const origen = params.get('origen');
        const destino = params.get('destino');
        const personas = parseInt(params.get('personas'), 10);
        const fecha = params.get('fecha');

        // Mostrar los valores en la página
        document.getElementById('origen').textContent = origen;
        document.getElementById('destino').textContent = destino;
        document.getElementById('personas').textContent = personas;
        document.getElementById('fecha').textContent = fecha;

        // Datos de duración de viaje entre las localidades seleccionadas (en minutos)
        const duracionesViaje = {
            'San Pedro-San Salvador': 60,
            'San Pedro-Ledesma': 60,
            'San Salvador-San Pedro': 60,
            'San Salvador-Ledesma': 120,
            'Ledesma-San Pedro': 60,
            'Ledesma-San Salvador': 120
        };

        // Datos de precios de boleto
        const preciosBoleto = {
            'San Pedro-San Salvador': 4800,
            'San Pedro-Ledesma': 3900,
            'San Salvador-San Pedro': 4800,
            'San Salvador-Ledesma': 9200,
            'Ledesma-San Pedro': 3900,
            'Ledesma-San Salvador': 9200
        };

        // Función para agregar ceros a horas y minutos
        function agregarCero(num) {
            return num < 10 ? '0' + num : num;
        }

        // Función para generar los horarios
        function generarHorarios(origen, destino) {
            const claveViaje = `${origen}-${destino}`;
            const duracion = duracionesViaje[claveViaje];
            const precio = preciosBoleto[claveViaje];
            if (!duracion || !precio) {
                document.getElementById('lista-horarios').innerHTML = `<li>No hay horarios disponibles para este trayecto.</li>`;
                document.getElementById('costo-total').innerHTML = ''; // Limpiar costo total si no hay horarios
                return;
            }

            let horarios = '';
            const horaInicio = 7; // Colectivos salen desde las 7 AM
            const horaFin = 23; // Hasta las 11 PM
            const intervalo = duracion === 120 ? 120 : 60; // Intervalos de horarios (cada 2 horas si duración es 120 min, cada 1 hora si es 60 min)

            for (let hora = horaInicio; hora <= horaFin; hora++) {
                for (let minutos = 0; minutos < 60; minutos += intervalo) {
                    const horaSalida = hora;
                    const minutosSalida = minutos;

                    // Calcular la hora de llegada sumando la duración del viaje
                    const totalMinutosSalida = horaSalida * 60 + minutosSalida;
                    const totalMinutosLlegada = totalMinutosSalida + duracion;
                    const horaLlegada = Math.floor(totalMinutosLlegada / 60);
                    const minutosLlegada = totalMinutosLlegada % 60;

                    // Asegurar que la hora de llegada se mantenga en el formato de 24 horas
                    const horaLlegadaFormateada = agregarCero(horaLlegada % 24); // Usa el operador % para ajustar las horas
                    const minutosLlegadaFormateada = agregarCero(minutosLlegada);

                    // Formatear las horas y minutos con dos dígitos
                    const horaSalidaFormateada = `${agregarCero(horaSalida)}:${agregarCero(minutosSalida)}`;
                    const horaLlegadaCompletaFormateada = `${horaLlegadaFormateada}:${minutosLlegadaFormateada}`;

                    // Formatear el precio
                    const precioFormateado = `$${precio.toLocaleString()}`;

                    horarios += `<li><span class="hora-salida">${horaSalidaFormateada}</span> - <span class="hora-llegada">${horaLlegadaCompletaFormateada}</span> <span class="ruta">${origen} - ${destino}</span> <span class="precio">${precioFormateado}</span></li>`;
                }
            }

            document.getElementById('lista-horarios').innerHTML = horarios;

            // Mostrar el costo total si hay 2 o más personas
            if (personas > 1) {
                const costoTotal = preciosBoleto[claveViaje] * personas;
                document.getElementById('costo-total').innerHTML = `<p><strong>Costo Total:</strong> $${costoTotal.toLocaleString()}</p>`;
            } else {
                document.getElementById('costo-total').innerHTML = ''; // Limpiar costo total si hay solo una persona
            }
        }

        // Llamar a la función para generar los horarios solo con las localidades permitidas
        if (['San Pedro', 'San Salvador', 'Ledesma'].includes(origen) && ['San Pedro', 'San Salvador', 'Ledesma'].includes(destino)) {
            generarHorarios(origen, destino);
        } else {
            document.getElementById('lista-horarios').innerHTML = `<li>Las localidades seleccionadas no están disponibles.</li>`;
            document.getElementById('costo-total').innerHTML = ''; // Limpiar costo total si no hay horarios
        }
    </script>

    <footer id="contacto">
        <div id="mapa">
            <iframe
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d29107.900556685392!2d-64.8790141711123!3d-24.224720164352878!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x941a587a9e2eadb1%3A0x539840e1029883e3!2sTerminal%20de%20%C3%93mnibus%20de%20San%20Pedro%20de%20Jujuy%20%22Coronel%20Eustaquio%20Medina%22!5e0!3m2!1ses-419!2sar!4v1726153516522!5m2!1ses-419!2sar"
                width="100%" height="350" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
            </iframe>
        </div>
        <div class="contacto">
            <p>&copy; 2024 ARBASTA SRL. Todos los derechos reservados.</p>
            <a href="https://wa.me/3888617303" target="_blank" rel="noopener noreferrer">
                <img src="imagenes/whatsapp_-_logo_negro_1.png" alt="WhatsApp" style="width: 50px; height: 30px;">
                Chatea con nosotros
            </a>
        </div>
    </footer>
</body>
</html>
